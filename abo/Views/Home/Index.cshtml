
<!doctype html>
<html>
<head>
    <title>驾管业务全程网办</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css">
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
    <style>
        .sdulli{
            font-size:.9em
        }
    </style>
</head>
<body>
      <div data-role="page" id="aboall">
        <div data-role="header">
            <h1>查看全程网办综合统计数据</h1>
        </div><!-- /header -->
        <div role="main" class="ui-content">
            <ul class="sdulli" id="aboallul">            </ul>
    <script>
        if (typeof (EventSource) !== "undefined") {
            var source = new EventSource("http://app.ytjj.gov.cn/sdyycjg/aboallStatistics");
            source.onmessage = function (event) {
                console.log(event.data);
                console.dir(event);
                document.getElementById("aboallul").innerHTML = event.data + "<br>";
            };
        }       
    </script>
            <p><a href="#foo">查看分类数据统计</a></p>
        </div><!-- /content -->
        <div data-role="footer">
            <h4>山东云一提供技术支持</h4>
        </div><!-- /footer -->

    </div><!-- /page -->
    <div data-role="page" id="foo">
        <div data-role="header">
            <h1>驾管业务全程网办数据统计</h1>
        </div><!-- /header -->
        <div role="main" class="ui-content">
            <p id="foop">完整业务处理中数据统计</p>            
            <ul class="sdulli" id="foopul"></ul>
            <p> <a href="#bar">查看处理完成数据统计</a></p>
        </div><!-- /content -->
        <div data-role="footer">
            <h4>山东云一提供技术支持</h4>
        </div><!-- /footer -->
    </div><!-- /page -->
    <!-- Start of second page -->
    <div data-role="page" id="bar">
        <div data-role="header">
            <h1>驾管业务全程网办数据统计</h1>
        </div><!-- /header -->
        <div role="main" class="ui-content">
            <p id="barp">完整业务处理完成数据统计</p>
            <ul class="sdulli" id="barpul">            </ul>
            <p><a href="#abstudy">查看AB证审验教育数据统计</a></p>
        </div><!-- /content -->
        <div data-role="footer">
            <h4>山东云一提供技术支持</h4>
        </div><!-- /footer -->
    </div><!-- /page -->

      <div data-role="page" id="abstudy">
        <div data-role="header">
            <h1>AB证审验教育数据统计</h1>
        </div><!-- /header -->
        <div role="main" class="ui-content">
            <!-- <p id="barp">完整业务处理完成数据统计</p> -->
            <ul class="sdulli" id="abul">            </ul>
            <div id="result"></div>
    <script>
        if (typeof (EventSource) !== "undefined") {
            var source = new EventSource("http://app.ytjj.gov.cn/sdyycjg/abStatistics1");
            source.onmessage = function (event) {
                console.log(event.data);
                console.dir(event);
                document.getElementById("abul").innerHTML = event.data + "<br>";
            };
        }
        else {
            document.getElementById("result").innerHTML = "抱歉，你的浏览器不支持 server-sent 事件...";
        }
    </script>
            <p><a href="#aboall">查看全程网办综合统计数据</a></p>
        </div><!-- /content -->
        <div data-role="footer">
            <h4>山东云一提供技术支持</h4>
        </div><!-- /footer -->

    </div><!-- /page -->
    <script>
        $(document).ready(function () {
             console.log(" window.location.search: " + window.location.search);
            $.ajax({
                <!-- url: "/searchStatistics", -->
                   url: "/sdyycjg/searchStatistics",
                data: {
                    startdate: "1999-1-1",
                    enddate: "2999-1-1"
                }
            }).done(function (json) {
                if (json.status) alert("Sorry, there was a problem!" + json.content);
                else {
                    //var ret = " ";
                    //$.each(json.completed.bcount, function (key, value) {
                    //    ret += "<li>" + key + "," + value + "</li>";
                    //});//json.completed.total+"completed"+
                    $("#barpul").html(json.comhtml);
                    $("#foopul").html(json.onhtml);
                    //ret = "-";
                    //$.each(json.ongoing.bcount, function (key, value) {
                    //    ret += key + "=" + value + ",";
                    //})
                    //$("#foop").html(json.ongoing.total + "ongoing" + ret);
                }

            })
                .fail(function (xhr, status, errorThrown) {
                    alert("Sorry, there was a problem!");
                    console.log("Error: " + errorThrown);
                    console.log("Status: " + status);
                    console.dir(xhr);
                })
                .always(function (xhr, status) {
    //alert("The request is complete!"); 
  });

    $.ajax({
                url: "/sdyycjg/abStatistics",
                data: {
                    startdate: "1999-1-1",
                    enddate: "2999-1-1"
                }
            }).done(function (json) {
                if (json.status) alert("Sorry, there was a problem!" + json.content);
                else {
                   
                    $("#abul").html(json.onhtml);
                }

            })
                .fail(function (xhr, status, errorThrown) {
                    alert("Sorry, there was a problem!");
                    console.log("Error: " + errorThrown);
                    console.log("Status: " + status);
                    console.dir(xhr);
                })
                .always(function (xhr, status) {
    //alert("The request is complete!"); 
  });
        });
    </script>
</body>
</html>
